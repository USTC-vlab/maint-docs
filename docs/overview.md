# Vlab 第二代服务器集群

## 计算服务器 {#compute-server}

第二代 Vlab 的计算服务器共有 16 台，其中 14 台为普通服务器（8 台一批次，6 台二批次），2 台为 GPU 服务器，另有两批次各台存储服务器。

### 普通计算服务器 {#compute-server-cpu}

第一批 8 台普通计算服务器分别命名为 pv1 到 pv8，每台服务器包含双路 Intel Xeon Scalable Silver 4110 处理器（共 16 核心、32 线程），预装内存 32 GB（2 x 16 GB DDR4 2400 ECC），硬盘配置为两块 HPE SSD 480GB 和三块 2.4 TB 10K SAS 硬盘（取出来放进存储服务器的额外硬盘笼）

所有服务器的内存在购入时均升级至 160 GB（2 x 16 GB + 4 x 32 GB），其中 pv2 ~ pv8 的内存在 2020 年 3 月底再次升级至 224 GB（2 x 16 GB + 6 x 32 GB）。

网络方面，这款服务器自带一个四口千兆网卡（系统内名称为 `eno1` 到 `eno4`），一个百兆口连接 HPE iLO 5（即 HPE 的 IPMI 远程管理卡）。另外每台服务器扩展了两个 10 Gbps 的光纤接口（分别为 `ens1f0` 和 `ens1f1`），通过一个光交换机在所有计算服务器和存储服务器的 iSCSI 端口实现一个内网互联。

[第一代 Vlab](history/gen1.md) 的唯一一台服务器在重装后有限提供服务，命名为 pv0，因此集群共有 11 台计算服务器。与 2019 年秋季时相比，它多了 32 GB 的内存（NUMA 不均衡）和一块 Intel X520-DA2 光纤卡用于接入光纤网络（但是最后没接上，目前用于[测试平台](testing/index.md)）。

主机的 IPMI 地址为 10.38.79.100 至 10.38.79.108，最后一位数字和主机名一致，详见 [IP 地址列表](networking/ips.md)。

---

第二批 6 台普通计算服务器分别命名为 pv9 到 pv14，每台服务器包含双路 Intel Xeon Scalable Silver 4314 处理器（共 32 核心、64 线程），预装内存 256 GB（8 x 32 GB DDR4 2666 ECC），硬盘配置为两块 960 GB SSD（杂牌 SSSTC ER2-CD960A）。这款服务器配置了一块双口 I350（可能是板载）网卡和一块双口 82599ES SFP+ 网卡，以及独立的 IPMI 网口。新批次的服务器之间有一台新的光口交换机互联，新旧交换机之间有一个 QSFP+ 40 Gbps 的光纤。

同前，主机的 IPMI 地址为 10.38.79.109 至 10.38.79.114。

### GPU 计算服务器 {#compute-server-gpu}

2 台 GPU 服务器，命名为 pvg1 和 pvg2，每台服务器包含双路 Intel Xeon Scalable Gold 5218 处理器（共 32 核心、64 线程），内存容量为 192 GB（组合及 NUMA 情况未知）。硬盘配置为两块 HPE SSD 480GB（pvg1 另有四块 Intel DC S4500 480GB），网卡配置与 CPU 计算服务器一致。

其中 pvg1 安装有两块 RTX 2070 Super GPU（可能为技嘉），pvg2 安装有一块 RTX 2070 Super GPU（型号未知）和一块 Quadro RTX 6000 GPU。

## 操作系统 {#operating-system}

这批服务器全部安装 [Proxmox VE](https://pve.proxmox.com/) 系统，基于 Debian。本平台使用 Proxmox VE 管理 LXC 容器和 KVM 虚拟机。

## 存储服务器 {#storage-server}

存储服务器为 HPE MSA 1050，有 24 个 2.5 寸 SAS 盘位和两个 iSCSI 控制器。购买时带有 18 块 1.2 TB 的硬盘，后来邢凯老师提供了一个额外的硬盘笼，扩展了 24 个盘位，正好放下 8 台计算服务器各自带的 3 块机械硬盘。

该存储服务器有两个控制器，每个控制器各有一个以太网口（用于管理界面）和两个光纤接口（10 Gbps，用于数据传输）。目前两个控制器的管理接口都接入校园网，地址分别为 [10.38.79.98](https://10.38.79.98/) 和 [10.38.79.99](https://10.38.79.99/)。

## 机房 {#location}

机房在电三楼 524：

- 第一批八台计算服务器（pv1 到 pv8）在 5 号机柜，标签为 ==VLAB 1== 到 ==VLAB 8==
- 第一批存储服务器的两个硬盘笼在 5 号机柜最下方（标签 ==VLAB S0== 和 ==VLAB S1==），第三个闲置硬盘笼在旁边 6 号机柜正中间
- 第二批六台计算服务器（pv9 到 pv14）在 8 号机柜，暂未贴标签，从下往上为 pv9 到 pv14
- 第二批存储服务器也在 8 号机柜中
- pvg1 和 pvg2 在对面一排的某个机柜靠下的位置（HPE 塔式服务器，横放在铁板上）
- pv0 在 4 号机柜*最*下方

5 号机柜和 8 号机柜背后最上方各有一个光交换机和电交换机，参见[网络配置](networking/index.md)。

## 其他资源 {#resources}

学校官方域名 `vlab.ustc.edu.cn` 属于本项目，指向 A 202.38.75.226 及 AAAA 2001:da8:d800:75::226。另有静态 IP 地址 202.38.75.252 用作学生机网关，没有域名。关于 IP 地址详见[这个页面](networking/ips.md)。

所有计算服务器的 IPMI 网页、存储服务器的两个管理接口以及我们的测试环境都使用自己的 CA 签发的证书。该 CA 目前由 iBug 管理，CA 证书在[这里](assets/iBug_Vlab_CA.crt)，可以添加到系统的证书信任列表中，方便后续管理机器。
